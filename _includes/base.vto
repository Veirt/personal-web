<!DOCTYPE html>
<html lang="{{ site.lang || 'en' }}">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="robots" content="index, follow" />
        <meta name="googlebot" content="index, follow" />

        <title>{{ title }}{{ if title }} | {{ /if }}{{ site.title }}</title>
        <meta
            name="description"
            content="{{ description || site.description }}"
        >
        <meta name="author" content="{{ site.author.name }}">
        <meta
            name="keywords"
            content="{{ site.keywords |> join(', ') }}{{ if tags }}, {{ tags |> join(', ') }}{{ /if }}"
        >
        <link rel="canonical" href="{{ site.url }}{{ url }}">

        <meta
            name="google-site-verification"
            content="a5qBFQJgk8sV0G6bSwwx4D53rpPMXScRcsSu2SXxDEs"
        />

        <!-- Open Graph -->
        <meta
            property="og:type"
            content="{{ if type == 'blog' }}article{{ else }}website{{ /if }}"
        >
        <meta property="og:url" content="{{ site.url }}{{ url }}">
        <meta property="og:title" content="{{ title || site.title }}">
        <meta
            property="og:description"
            content="{{ description || site.description }}"
        >
        <meta property="og:site_name" content="{{ site.title }}">
        <meta property="og:locale" content="en_US">
        {{ if og_image }}
            <meta property="og:image" content="{{ site.url }}{{ og_image }}">
        {{ else }}
            <meta property="og:image" content="{{ site.url }}/favicon.png">
        {{ /if }}
        <meta property="og:image:width" content="512">
        <meta property="og:image:height" content="512">
        <meta property="og:image:type" content="image/png">

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="{{ title || site.title }}">
        <meta
            name="twitter:description"
            content="{{ description || site.description }}"
        >
        <meta name="twitter:url" content="{{ site.url }}{{ url }}">
        {{ if og_image }}
            <meta name="twitter:image" content="{{ site.url }}{{ og_image }}">
        {{ else }}
            <meta name="twitter:image" content="{{ site.url }}/favicon.png">
        {{ /if }}
        {{ if type == 'blog' }}
            <meta property="article:author" content="{{ site.author.name }}">
            <meta
                property="article:published_time"
                content="{{ date |> date('DATETIME') }}"
            >
            {{ if tags }}
                {{ for tag of tags }}
                    <meta property="article:tag" content="{{ tag }}">
                {{ /for }}
            {{ /if }}
        {{ /if }}

        <link rel="icon" href="/favicon.png" sizes="any">
        <link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="apple-touch-icon" href="/apple-touch-icon.png">
        <link rel="manifest" href="/site.webmanifest">

        <link
            rel="alternate"
            type="application/rss+xml"
            title="{{ site.title }} RSS Feed"
            href="{{ site.url }}/feed.xml"
        >

        <link rel="dns-prefetch" href="https://github.com">
        <link rel="preconnect" href="https://cdn.jsdelivr.net">

        <link rel="stylesheet" href="/style.css" />
        <style>
            .turbo-progress-bar {
                background-color: var(--primary);
            }
        </style>

        <link
            rel="preload"
            href="/snow.css"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'"
        >
        <noscript><link rel="stylesheet" href="/snow.css"></noscript>

        <link
            rel="preload"
            href="/highlight-nord.css"
            as="style"
            onload="this.onload=null;this.rel='stylesheet'"
        >
        <noscript><link rel="stylesheet" href="/highlight-nord.css"></noscript>

        <script defer src="/snow.js"></script>
        <script src="/theme.js"></script>
        <script
            type="module"
            src="https://cdn.jsdelivr.net/npm/@hotwired/turbo@latest/dist/turbo.es2017-esm.min.js"
            defer
        ></script>
        <script
            defer
            src="https://cloud.umami.is/script.js"
            data-website-id="096fb35a-3087-4cfd-b7ef-c4cb9b1787c1"
        ></script>
    </head>

    <body class="bg-background text-text text-base leading-relaxed">

        <!-- Mobile top bar -->
        <header class="md:hidden flex items-center justify-between px-5 py-4 border-b border-border sticky top-0 bg-background z-50" role="banner">
            <a href="/" class="font-mono text-sm font-semibold text-text/70 tracking-widest">veirt.</a>
            <div class="flex items-center gap-2">
                <button
                    class="theme-toggle-btn"
                    id="theme-toggle-mobile"
                    aria-label="Toggle between light and dark theme"
                    aria-pressed="false"
                >
                    <div class="theme__icon theme__icon--sun i-solar:sun-line-duotone text-base"></div>
                    <div class="theme__icon theme__icon--moon i-solar:moon-line-duotone text-base"></div>
                </button>
                <button
                    class="border border-border p-2 cursor-pointer text-text hover:text-primary hover:border-primary transition-colors duration-200"
                    id="mobile-menu-toggle"
                    aria-label="Toggle navigation menu"
                    aria-expanded="false"
                    aria-controls="sidebar-mobile"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true" id="menu-icon-open">
                        <path fill="currentColor" d="M3 18v-2h18v2zm0-5v-2h18v2zm0-5V6h18v2z"/>
                    </svg>
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true" id="menu-icon-close" class="hidden">
                        <path fill="currentColor" d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12z"/>
                    </svg>
                </button>
            </div>
        </header>

        <div class="flex min-h-screen">
            <aside
                id="sidebar"
                class="hidden md:flex flex-col w-56 fixed top-0 left-0 h-screen z-40 bg-background"
                role="navigation"
                aria-label="Main navigation"
            >
                <div class="flex-1 flex flex-col justify-center pl-8 pr-4">
                    <p
                        href="/"
                        class="font-mono text-sm font-semibold text-text tracking-widest hover:text-text/90 transition-colors duration-200 mb-8"
                    >veirt.</p>

                    <nav aria-label="Primary navigation">
                        <ul class="flex flex-col gap-0.5 list-none m-0 p-0" role="list">
                            <li>
                                <a
                                    class="sidebar-nav-item {{ if url == '/' }}sidebar-nav-item-active{{ /if }}"
                                    href="/"
                                    aria-current="{{ if url == '/' }}page{{ /if }}"
                                >Home</a>
                            </li>
                            <li>
                                <a
                                    class="sidebar-nav-item {{ if url |> startsWith('/projects') }}sidebar-nav-item-active{{ /if }}"
                                    href="/projects/"
                                    aria-current="{{ if url |> startsWith('/projects') }}page{{ /if }}"
                                >Projects</a>
                            </li>
                            <li>
                                <a
                                    class="sidebar-nav-item {{ if url |> startsWith('/blog') }}sidebar-nav-item-active{{ /if }}"
                                    href="/blog/"
                                    aria-current="{{ if url |> startsWith('/blog') }}page{{ /if }}"
                                >Blog</a>
                            </li>
                            <li>
                                <a
                                    class="sidebar-nav-item {{ if url == '/now/' }}sidebar-nav-item-active{{ /if }}"
                                    href="/now/"
                                    aria-current="{{ if url == '/now/' }}page{{ /if }}"
                                >Now</a>
                            </li>
                        </ul>
                    </nav>

                    <div class="mt-6">
                        <button
                            class="theme-toggle-btn"
                            id="theme-toggle"
                            aria-label="Toggle between light and dark theme"
                            aria-pressed="false"
                        >
                            <div class="theme__icon theme__icon--sun i-solar:sun-line-duotone text-base"></div>
                            <div class="theme__icon theme__icon--moon i-solar:moon-line-duotone text-base"></div>
                        </button>
                    </div>
                </div>
            </aside>

            <div id="sidebar-overlay" class="fixed inset-0 bg-background/80 backdrop-blur-sm z-30 hidden md:hidden" aria-hidden="true"></div>

            <aside
                id="sidebar-mobile"
                class="hidden flex-col w-64 border-r border-border fixed top-0 left-0 h-screen z-40 bg-background overflow-y-auto md:hidden"
                style="transform: translateX(-100%); transition: transform 0.3s ease;"
                role="navigation"
                aria-label="Mobile navigation"
            >
                <div class="flex-1 flex flex-col justify-center pl-7 pr-4">
                    <a href="/" class="font-mono text-sm font-semibold text-text/60 tracking-widest mb-8 inline-block">veirt.</a>
                    <ul class="flex flex-col gap-0.5 list-none m-0 p-0" role="list">
                        <li><a class="sidebar-nav-item {{ if url == '/' }}sidebar-nav-item-active{{ /if }}" href="/">Home</a></li>
                        <li><a class="sidebar-nav-item {{ if url |> startsWith('/projects') }}sidebar-nav-item-active{{ /if }}" href="/projects/">Projects</a></li>
                        <li><a class="sidebar-nav-item {{ if url |> startsWith('/blog') }}sidebar-nav-item-active{{ /if }}" href="/blog/">Blog</a></li>
                        <li><a class="sidebar-nav-item {{ if url == '/now/' }}sidebar-nav-item-active{{ /if }}" href="/now/">Now</a></li>
                    </ul>
                    <div class="mt-6">
                        <button
                            class="theme-toggle-btn"
                            id="theme-toggle-mobile-sidebar"
                            aria-label="Toggle between light and dark theme"
                            aria-pressed="false"
                        >
                            <div class="theme__icon theme__icon--sun i-solar:sun-line-duotone text-base"></div>
                            <div class="theme__icon theme__icon--moon i-solar:moon-line-duotone text-base"></div>
                        </button>
                    </div>
                </div>
            </aside>

            <main
                class="flex-1 md:ml-56 min-h-screen p-6 sm:p-10 lg:p-14"
                role="main"
            >
                {{ content }}
            </main>

        </div>

        <script>
            (function () {
                var toggle = document.getElementById('mobile-menu-toggle');
                var sidebar = document.getElementById('sidebar-mobile');
                var overlay = document.getElementById('sidebar-overlay');
                var iconOpen = document.getElementById('menu-icon-open');
                var iconClose = document.getElementById('menu-icon-close');

                if (!toggle || !sidebar) return;

                function openMenu() {
                    sidebar.classList.remove('hidden');
                    sidebar.classList.add('flex');
                    requestAnimationFrame(function () {
                        sidebar.style.transform = 'translateX(0)';
                    });
                    overlay.classList.remove('hidden');
                    toggle.setAttribute('aria-expanded', 'true');
                    iconOpen.classList.add('hidden');
                    iconClose.classList.remove('hidden');
                }

                function closeMenu() {
                    sidebar.style.transform = 'translateX(-100%)';
                    overlay.classList.add('hidden');
                    toggle.setAttribute('aria-expanded', 'false');
                    iconOpen.classList.remove('hidden');
                    iconClose.classList.add('hidden');
                    setTimeout(function () {
                        sidebar.classList.add('hidden');
                        sidebar.classList.remove('flex');
                    }, 300);
                }

                toggle.addEventListener('click', function () {
                    var isOpen = toggle.getAttribute('aria-expanded') === 'true';
                    if (isOpen) closeMenu(); else openMenu();
                });

                overlay.addEventListener('click', closeMenu);
            })();
        </script>
    </body>
</html>
